---
title: "A3: SPL Library Checkouts"
output: html_document
---

### Introduction

An introduction of the data and a description of the trends/books/items you are choosing to analyze (and why!)

### Summary Information

Write a summary paragraph of findings that includes the 5 values calculated from your summary information R script

These will likely be calculated using your DPLYR skills, answering questions such as:

- What is the average number of checkouts for each item?
- What is the month or year with the most/least checkouts for a book that you're interested in?
- What is the month or year with the most/least checkouts for ebooks?
- How has the number of print book checkouts changed over time?

Feel free to calculate and report values that you find relevant.

### The Dataset

- Who collected/published the data?  
- What are the parameters of the data (dates, number of checkouts, kinds of books, etc.)?
- How was the data collected or generated?  
- Why was the data collected?  
- What, if any, ethical questions do you need to consider when working with this data?  
- What are possible limitations or problems with this data?   (at least 200 words)


### First Trends Over Time Chart

Include a chart. Make sure to describe why you included the chart, and what patterns emerged

The first chart that you will create and include will show the trend over time of your variable/topic/interest. Think carefully about what you want to communicate to your user (you may have to find relevant trends in the dataset first!). Here are some requirements to help guide your design:

- Show more than one, but fewer than ~10 trends
  - For example, two books, or 5 different mediums
- You must have clear x and y axis labels
- The chart needs a clear title 
- You need a legend for your different line colors and a clear - legend title
In your .Rmd file, make sure to describe why you included the chart, and what patterns emerged

When we say "clear" or "human readable" titles and labels, that means that you should not just display the variable name.

Here's an example of how to run an R script inside an RMarkdown file:

``````{r, echo = FALSE, warning = FALSE, message = FALSE}
# Question: Are Victoria Scwabs old books or new books more popular within the last year?

#load Libraries
library("dplyr")
library("ggplot2")

# load Data Frame
Schwab_df <- read.csv("Schwab_Checkouts_by_Title.csv", stringsAsFactors = F)

# modify Data Frame
last_year_df <- Schwab_df %>%
  filter(CheckoutYear == "2022", UsageClass == "Physical", MaterialType == "BOOK") %>%
  mutate(PublicationYear = gsub("\\[", "", PublicationYear)) %>%
  mutate(PublicationYear = gsub("\\]", "", PublicationYear)) %>%
  mutate(PublicationYear = gsub("\\.", "", PublicationYear)) %>%
  group_by(PublicationYear) %>%
  summarise(Checkouts = sum(Checkouts)) %>%
  mutate(PublicationYear = as.integer(PublicationYear))


# make chart
popularity <- ggplot(last_year_df) +
  geom_line(aes(x = PublicationYear,
                y = Checkouts)) +
  scale_x_continuous(breaks = seq(2013, 2022, 1)) +
  labs(x = "Publication Year", 
       y = "Number of Checkouts in 2022",
       title = "Victoria Schwab Books Checkout's This Year by Publication Year")

# call chart
popularity
```

### Second Trends Over Time Chart

Include a chart. Make sure to describe why you included the chart, and what patterns emerged

The second chart that you will create and include will show another trend over time of your variable/topic/interest. Think carefully about what you want to communicate to your user (you may have to find relevant trends in the dataset first!). Here are some requirements to help guide your design:

- Show more than one, but fewer than ~10 trends
  - For example, two books, or 5 different mediums
- You must have clear x and y axis labels
- The chart needs a clear title 
- You need a legend for your different line colors and a clear - legend title
In your .Rmd file, make sure to describe why you included the chart, and what patterns emerged

When we say "clear" or "human readable" titles and labels, that means that you should not just display the variable name.

Here's an example of how to run an R script inside an RMarkdown file:

``````{r, echo = FALSE}
# Question: Is Victoria Schwabs popularity growing or decreasing? If decreasing, which year was her most popular? 

#load Libraries
library("dplyr")
library("ggplot2")

# load Data Frame
Schwab_df <- read.csv("Schwab_Checkouts_by_Title.csv", stringsAsFactors = F)

# modify Data Frame
most_checked_df <- Schwab_df %>%
  filter(CheckoutYear != "2023") %>%
  filter(CheckoutYear != "2011") %>%
  group_by(CheckoutYear) %>%
  summarise(Checkouts = sum(Checkouts))
  
  


# make chart
Checkouts_year <- ggplot(most_checked_df) +
  geom_line(aes(x = CheckoutYear,
                y = Checkouts)) +
  scale_x_continuous(breaks = seq(2012, 2022, 1)) +
  labs(x = "Year of Checkout", 
       y = "Amount of Checkouts in Any Medium",
       title = "Victoria Schwab's Popularity Over the Years")

# call chart
Checkouts_year
  
```

### Your Choice

The last chart is up to you. It could be a line plot, scatter plot, histogram, bar plot, stacked bar plot, and more. Here are some requirements to help guide your design:

- You must have clear x and y axis labels
- The chart needs a clear title 
- You need a legend for your different line colors and a clear legend title

Here's an example of how to run an R script inside an RMarkdown file:

``````{r, echo = FALSE}
# Question: Which Victoria Schwab book is the most popular in the past year?

#load Libraries
library("dplyr")
library("ggplot2")

# load Data Frame
Schwab_df <- read.csv("Schwab_Checkouts_by_Title.csv", stringsAsFactors = F)

# modify Data Frame
popular_df <- Schwab_df %>%
  filter(CheckoutYear == "2022", UsageClass == "Physical", MaterialType == "BOOK") %>%
  select(Title, Checkouts) %>%
  mutate(Title = gsub("/ V. E. Schwab.", "", Title)) %>%
  mutate(Title = gsub("/ V.E. Schwab.", "", Title)) %>%
  mutate(Title = gsub("/ Victoria Schwab\\.", "", Title)) %>%
  mutate(Title = gsub("/ writer, V.E. Schwab ; artist, Enid Balám ; colorist, Jordi Escuin Liorach ; letterer, Rob Steen.", "", Title)) %>%
  mutate(Title = gsub("; \\[Interior illustrations by Manuel Šumberac\\].", "", Title)) %>%
  mutate(Title = gsub("La vida invisible de Addie Larue ; traducción de Patricia Sebastián.", "The invisible life of Addie LaRue ", Title)) %>%
  mutate(Title = gsub(". 1 ", "", Title)) %>%
  mutate(Title = trimws(Title)) %>%
  group_by(Title) %>%
  summarise(Checkouts = sum(Checkouts))

# make chart
Pop_book <- ggplot(popular_df) +
  geom_col(aes(x = Checkouts,
               y = Title,
               fill = Checkouts)) +
  labs(x = "Amount of Checkouts", 
       y = "Victoria Schwab Books",
       title = "Amount of Checkouts For Each Victoria Schwab Book")

# call chart
Pop_book
```


